<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tumo.model.dao.UserDao">

	<insert id="createUser"  parameterType="userdto">
		insert into user (nickname, email, password, introduce)
			values (#{nickname}, #{email}, #{password}, #{introduce})
	</insert>
	
	<select id="findUserByEmail" parameterType="string" resultType="userdto">
		select user_idx as userIdx, nickname, email, login_type as loginType, introduce, 
				disclosure, create_at as createAt, update_at as updateAt, deleted 
			from user
			having email = #{email} 
	</select>
	
	<select id="findUserByNickname" parameterType="string" resultType="userdto">
		select user_idx as userIdx, nickname, email, login_type as loginType, introduce, 
				disclosure, create_at as createAt, update_at as updateAt, deleted 
			from user
			where nickname = #{nickname} 
	</select>
	
	<insert id="insertUserTag" parameterType="map">
		insert into user_tag (user_idx, content)
			values (#{userIdx}, #{content})
	</insert>
	
	<select id="findUserTagByUserIdxAndContent" parameterType="map" resultType="boolean">
		select if(count(*) != 0, 1, 0) from user_tag
			where user_idx = #{userIdx} and content = #{content}
	</select>
	
</mapper>